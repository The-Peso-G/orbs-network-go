version: '2.1'

services:
  ganache:
    image: trufflesuite/ganache-cli
    command: ganache-cli -a 10 -m "vanish junk genuine web seminar cook absurd royal ability series taste method identify elevator liquid"
    networks:
      orbs-network:
        ipv4_address: 192.168.199.6

  orbs-external:
    image: orbs:external
    environment:
      ETHEREUM_ENDPOINT: http://192.168.199.6:8545/
      ETHEREUM_PRIVATE_KEY: f2ce3a9eddde6e5d996f6fe7c1882960b0e8ee8d799e0ef608276b8de4dc7f19 # this keypair is generated from the mnemonic passed to ganache on startup
      ETHEREUM_PUBLIC_KEY: 037a809cc481303d337c1c83d1ba3a2222c7b1b820ac75e3c6f8dc63fa0ed79b18
      EXTERNAL_TEST: 'true'
    command: sh -c "sleep 3 && ./external.test -test.v"
    networks:
      orbs-network:
        ipv4_address: 192.168.199.5

networks:
  orbs-network:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 192.168.199.0/24
